<!DOCTYPE html>
<html lang="en">
<head>
    <title>SWC</title>
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <style>
        .dark {
        filter: invert(1) ;
        background-color: #202020;
        }

        /* This applies to ALL <img> elements inside .dark */
        .dark img, .dark iframe {
        filter: invert(1) ;
        }
        .dark a {
        filter: invert(1) ;
        color: #7ac8ff;
        }
        .dark input, .dark textarea, .dark select {
        filter: invert(1) ;
        background-color: #3a3a3a;
        color: white;
        }

    </style>
</head>
<body style="margin:0; font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif">

<div style ="height: 100vh; display: flex; flex-direction: column;">

    <h1 style = "margin: 5px;">Simple Web Chat (SWC) </h1>
    <div style="position:absolute; right:30px; top:10px">
        Dark Mode:
        <input type="checkbox" id="darkToggle" style = "position:absolute; top:1px">
    </div>
    
    
    <table style="flex: 1; width: 100%; height: 100%; border-collapse: collapse; border: none; table-layout: fixed; box-sizing: border-box; font-size: 18px; overflow: auto;">

        <tr style=" vertical-align: top; height: 100%;">
            <td style="width: 20%; height: 100%; border-right: 2px solid black; padding: 5px;">
                <div id = "logged-out"> 
                    <h2>Log In or Sign Up to Start</h2>
                    <button id = "logIn">Log In</button> 
                    <button id = "signUp">Sign Up</button>
                    <br>
                    <b>IMPORTANT! READ!</b>
                    <b><br>How logging in works:</b>
                    <p style="margin : 0; padding-top:0;"> If you have not created an account, enter your email adress and name. <br><br> You will be emailed your own permanent passcode. DO NOT LOSE IT. It is your passcode FOREVER. <br> You can read about why your passcode is chosen for you in the technical info link below.  <br>---<br> If you have an account, log in using your email and provided passcode. </p>
                </div>
                
                <div id = "logged-in">
                    <h2 id = logged-in-as></h2>
                    <p>Version 1.6
                        <br> New in this version: Commands! Chess! Dark Mode! Notifications for new messages that persist across sessions! Bug fixes!
                        <br> See the help and info page (bottom left) for more info.
                    </p>
                    <p>Refresh page to Log Out</p>
                </div>
                

                <div style=" position: absolute; bottom: 5px;">
                    
                    <a href="registry.html"target="_blank">Registry of Users</a>
                    <br>
                    <a href="help.html"target="_blank">Bug Reports, Suggestions, and Info</a>
                    <br>
                </div>
                

                
            </td>
            <td style="width: 30%; height: 100%; border-right: 2px solid black; padding: 5px;">
            
                <h2>Manage Chats</h2>
                <div id = "logged-in1">
                    <b>Select a chat to open: </b> <br>
                    <select name="Select Chat" id="selectChat" style="width: 100%; max-width: 100%">
                
                    <option value="" disabled selected>-- Select a chat to begin --</option>
                    </select>
                    <br>
                    <button id = "refreshChatList">Refresh Dropdown</button>

                    <br><br>
                    <b>Or create a new chat:</b>
                    <p>To create a chat, write down the email adresses of each person desired in the chat. Write each email on a new line. <br><br>Each person must have a registered account. You can use the registry (bottom left) to search for registered email addresses. You cannot create chats with invalid email adresses, or chats that already exist. <br><br> When you are done, click the "create chat" button. </p>
                    <textarea id="listInput" placeholder="Enter emails, one per line", style = "width: calc(100% - 8px); height: 200px; resize: none;"></textarea>
                    <br>
                    <button id = "createChat">Create Chat</button>
                </div>
                <div id = "logged-out1">
                    <p>You can't select or create a chat until you are logged in.</p>
                </div>
                


            </td>
            <td style="width: 50%; height: 100%; padding: 5px;">
                <h2>Chat With Others</h2>

                <div id = "logged-in2">
                    <b id = "chatHeader"> <- Select a chat to start</b>
                    <div id="messagesList", style = "overflow-y:auto; border:2px solid #000000; padding:5px; white-space:pre-wrap; font-family:monospace; font-size: 12px; width: calc(100% - 12px); height: 50vh; resize: none;"></div>
    
                    <div id = "msgInputDiv", style = "position: relative; margin-top: 5px; border:2px solid #000000; padding:5px;font-size: 14px; width: calc(100% - 12px); resize: none;">
                        <input type="text" id="msgInput" placeholder = "Enter message here...", style = "width: calc(100% - 60px)"></input>
                        
                        <button id = "sendMessage">Send</button>
                        <br>
                        <br>
                        <div id = "noFileUploaded">
                            To attach an image, drag and drop, or: <button id="uploadImg">Upload</button><input type="file" id="fileInput" style="display:none" />
                        </div>
                        <div id = "fileUploaded">
                            +Uploaded image
                            <button id="cancelImg">Cancel Image</button>
                            <br>
                        </div>

                        <br>
                        <div style = "font-size: 14px">Scroll to latest message:<input type="checkbox" id="scrollDown" name="scrollDown" value="scrollDown"></div>

                        <div style = "position: absolute;  bottom: -5px; right: 10px;">
                            <p>Commands: 
                                <br> /chat [clear, save]
                                <br> /game [chess, (more games soon!)] [email of opponent]
                            </p>
                        </div>
                    </div>
                    
                    <br>
                    <b>Don't write anything super sensitive or secretive! Messages are not end to end encrypted!</b>

                </div>
                <div id = "logged-out2">
                    <p>You... you also can't actually chat with others until you are logged in. You should probably log in.</p>
                </div>

            </td>
        </tr>
    </table>
</div>



<script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
</script>
<script src="https://cdn.jsdelivr.net/npm/js-sha256@0.9.0/build/sha256.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.min.js"></script>

<script src = "scripts/favicon.js?v=0.61"></script>
<script src = "scripts/main.js?v=0.62" type = "module"></script>


<div id="loading-overlay" style="
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(255,255,255,0.5);
    z-index: 9999;
    justify-content: center;
    align-items: center;
">
    <div class="spinner" style="
        border: 4px solid #ffffff;
        border-top: 4px solid #000000;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
    "></div>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>




</body>
</html>
